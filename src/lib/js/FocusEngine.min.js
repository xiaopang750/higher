/*
 * Version: 2.0.4
 * Build time: Tue Aug 30 2016 15:54:38 GMT+0800 (CST)
 * Copyright 2016, Alibaba
*/

!function(t){function i(o){if(e[o])return e[o].exports;var s=e[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var s=e(1),r=o(s);window.FocusEngine||(window.FocusEngine=r["default"])},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var s=e(2),r=o(s),n=e(3),h=o(n),l=e(4),d=o(l),a=e(5),c=o(a),f=e(7),u=o(f),g=e(8),p=o(g);window.requestAnimationFrame=window.requestAnimationFrame||function(t){setTimeout(t,0)};var y={Event:r["default"],Widget:h["default"],Switch:d["default"],Scroll:c["default"],Grid:u["default"],Grille:p["default"],roles:["Widget","Switch","Scroll","Grid","Grille"],render:function(){var t=arguments.length<=0||void 0===arguments[0]?document.body:arguments[0],i=t.getAttribute("fe-role");if(i&&-1===this.roles.indexOf(i))throw console.log(t),new Error("["+i+"]\u4e0d\u662f\u652f\u6301\u7684fe-role\u7c7b\u578b\uff0c\u53ea\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a"+this.roles.join("\u3001"));if(i||t.setAttribute("fe-role","Widget"),window.$FocusEngineGlobalRoot)return window.$FocusEngineGlobalRoot.reRender(),window.$FocusEngineGlobalRoot.getWidgetById(t.id);var e=document.body.getAttribute("fe-role");if(e&&-1===this.roles.indexOf(e))throw new Error("["+e+"]\u4e0d\u662f\u652f\u6301\u7684fe-role\u7c7b\u578b\uff0c\u53ea\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a"+this.roles.join("\u3001"));return e||(document.body.setAttribute("fe-role","Widget"),e="Widget"),window.$FocusEngineGlobalRoot=new this[e](document.body),window.$FocusEngineGlobalRoot.focus(),window.$FocusEngineGlobalRoot.handleRootEvent(),window.$FocusEngineGlobalRoot.getWidgetById(t.id)},createWidget:function(t){var i=t.getAttribute("fe-role");if(i&&-1===this.roles.indexOf(i))throw console.log(t),new Error("["+i+"]\u4e0d\u662f\u652f\u6301\u7684fe-role\u7c7b\u578b\uff0c\u53ea\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a"+this.roles.join("\u3001"));return i||t.setAttribute("fe-role","Widget"),new this[i](t)},appendWidget:function(t){for(var i=this.createWidget(t);t.parentNode;)if(t=t.parentNode,t.getAttribute("fe-role")){var e=t.id;return void this.getWidgetById(e).addChildWidget(i)}},getRoot:function(){return window.$FocusEngineGlobalRoot},getWidgetById:function(t){return window.$FocusEngineGlobalRoot?window.$FocusEngineGlobalRoot.getWidgetById(t):null},getFocusedLeaf:function(){return window.$FocusEngineGlobalRoot?window.$FocusEngineGlobalRoot.getFocusedLeaf():null},freeze:function(t){window.$FocusEngineGlobalRoot&&window.$FocusEngineGlobalRoot.freeze(t)},activate:function(){window.$FocusEngineGlobalRoot&&window.$FocusEngineGlobalRoot.activate()}};i["default"]=y,t.exports=i["default"]},function(t,i){"use strict";function e(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,i){for(var e=0;e<i.length;e++){var o=i[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(i,e,o){return e&&t(i.prototype,e),o&&t(i,o),i}}(),s=function(){function t(i,o,s){if(e(this,t),this.type=i,this._propagationStopped=!1,this._defaultPrevented=!1,this._listenerPrevented=!1,o&&(this.target=o),s)for(var r in s)this[r]=s[r]}return t.prototype.stopPropagation=function(){this._propagationStopped=!0},t.prototype.isPropagationStopped=function(){return this._propagationStopped},t.prototype.preventDefault=function(){this._defaultPrevented=!0},t.prototype.isDefaultPrevented=function(){return this._defaultPrevented},t.prototype.preventListener=function(){this._listenerPrevented=!0},t.prototype.isListenerPrevented=function(){return this._listenerPrevented},o(t,null,[{key:"VK_ENTER",get:function(){return 13}},{key:"VK_LEFT",get:function(){return 37}},{key:"VK_UP",get:function(){return 38}},{key:"VK_RIGHT",get:function(){return 39}},{key:"VK_DOWN",get:function(){return 40}}]),t}();i["default"]=s,t.exports=i["default"]},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=e(2),n=o(r),h=e(1),l=o(h),d=function(){function t(i){if(s(this,t),!i)throw new Error("[Focus Engine Error] \u521b\u5efa\u7ec4\u4ef6\u5fc5\u987b\u4f20\u5165\u76f8\u5e94\u7684\u5bb9\u5668\u5143\u7d20\u3002");if(this.con=i,this.con.id)this.id=this.con.id;else{for(var e=Math.random().toString().slice(2,12),o=!1;!o;)document.getElementById("fe-"+e)?e=Math.random().toString().slice(2,12):o=!0;this.id="fe-"+e,this.con.id=this.id}this.options=this._getOptions(i),this.parentWidget=null,this.focusedChildWidget=null,this.cachedChildWidget=null,this.active=!0,this.disabled="yes"===this.options.cfg.disable,this.disabled&&this.addClass("fe-disable"),this.eventListeners={},this._initChildWidgets()}return t.prototype.reRender=function(){document.querySelector("#"+this.id)&&(this.con=document.querySelector("#"+this.id),this.options=this._getOptions(this.con),this._reRenderChildWidget())},t.prototype.getFutureRect=function(){for(var t=this,i=t.getWidgetRect();t.getParentWidget();){var e=t.getParentWidget();e instanceof l["default"].Scroll&&("v"===e.dir?(i.top+=e.futureOffset,i.bottom+=e.futureOffset,i.centerY+=e.futureOffset):"h"===e.dir&&(i.left+=e.futureOffset,i.right+=e.futureOffset,i.centerX+=e.futureOffset)),e instanceof l["default"].Grid&&(e.horizontal?(i.left+=t.futureOffset,i.right+=t.futureOffset,i.centerX+=t.futureOffset):(i.top+=t.futureOffset,i.bottom+=t.futureOffset,i.centerY+=t.futureOffset)),t=e}return i},t.prototype._reRenderChildWidget=function(){for(var t=Array.prototype.slice.call(this.con.querySelectorAll("[fe-role]")),i=0;i<t.length;i++){var e=t[i],o=e.getAttribute("fe-role");if(-1===l["default"].roles.indexOf(o))throw console.log(e),new Error("["+o+"]\u4e0d\u662f\u652f\u6301\u7684fe-role\u7c7b\u578b\uff0c\u53ea\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a"+l["default"].roles.join("\u3001"));t=this._filterArray(t,Array.prototype.slice.call(t[i].querySelectorAll("[fe-role]")))}for(var i=0;i<this.childWidgets.length;i++)if(-1!==t.indexOf(this.childWidgets[i].getDOMNode())){var s=this.childWidgets[i].getDOMNode().getAttribute("fe-role");-1!==l["default"].roles.indexOf(s)&&this.childWidgets[i]instanceof l["default"][s]||(this.removeChildWidget(i),i--)}else this.removeChildWidget(i),i--;for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].reRender();for(var i=0;i<t.length&&t.length>this.childWidgets.length;i++){for(var r=t[i],n=!1,h=0;h<this.childWidgets.length;h++){var d=this.childWidgets[h];d.getDOMNode()===r&&(n=!0)}if(!n){var o=r.getAttribute("fe-role");if(-1!==l["default"].roles.indexOf(o)){var a=new l["default"][o](r);this.addChildWidget(a,i)}}}this.focused&&this.focus(!0,!0)},t.prototype.getRoot=function(){return window.$FocusEngineGlobalRoot},t.prototype.freeze=function(t){var i=this.getRoot();i&&(i.active=!1,t&&(i.focusedLeafBeforeFreeze=i.getFocusedLeaf(),i.blur()))},t.prototype.activate=function(){var t=this.getRoot();t&&(t.active=!0,t.focusedLeafBeforeFreeze&&(document.querySelector("#"+t.focusedLeafBeforeFreeze.id)===t.focusedLeafBeforeFreeze.getDOMNode()?t.focusedLeafBeforeFreeze.focus():t.focus(),t.focusedLeafBeforeFreeze=null))},t.prototype.disable=function(){this.disabled=!0,this.addClass("fe-disable")},t.prototype.enable=function(){this.disabled=!1,this.removeClass("fe-disable")},t.prototype._getOptions=function(t){var i={};this.feCfg=this._removeSpaces(t.getAttribute("fe-cfg"));var e={};if(this.feCfg){var o=this.feCfg.split(",");o.forEach(function(t){var i=t.split(":");return i.length<2?!1:void(e[i[0]]=i[1])})}i.cfg=e;var s=this._removeSpaces(t.getAttribute("fe-goto")),r={};if(s){var n=s.split(";");n[0]&&(r.up=n[0]),n[1]&&(r.right=n[1]),n[2]&&(r.down=n[2]),n[3]&&(r.left=n[3])}return i.dir=r,i.tab=this._removeSpaces(t.getAttribute("fe-index")),i},t.prototype._initChildWidgets=function(){this.childWidgets=[];for(var t=Array.prototype.slice.call(this.con.querySelectorAll("[fe-role]")),i=0;i<t.length;i++){var e=t[i],o=e.getAttribute("fe-role");if(-1===l["default"].roles.indexOf(o))throw console.log(e),new Error("["+o+"]\u4e0d\u662f\u652f\u6301\u7684fe-role\u7c7b\u578b\uff0c\u53ea\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\uff1a"+l["default"].roles.join("\u3001"));t=this._filterArray(t,Array.prototype.slice.call(t[i].querySelectorAll("[fe-role]")))}for(var s,r,i=0,n=t.length;n>i;i++){s=t[i];var o=s.getAttribute("fe-role");-1!==l["default"].roles.indexOf(o)&&(r=new l["default"][o](s),this.addChildWidget(r))}},t.prototype.handleRootEvent=function(){var t=this;document.addEventListener("keydown",function(i){if(t.active){i=i||window.event;var e=i.keyCode,o=t.getFocusedLeaf();e&&(o.fire(new n["default"]("keydown",o,{keyCode:e})),o&&e===n["default"].VK_ENTER&&o.fire(new n["default"]("okdown",o,{keyCode:e})),i.preventDefault())}}),document.addEventListener("keyup",function(i){if(t.active){i=i||window.event;var e=i.keyCode,o=t.getFocusedLeaf();e&&(o&&o.fire(new n["default"]("keyup",o,{keyCode:e})),o&&e===n["default"].VK_ENTER&&o.fire(new n["default"]("ok",o,{keyCode:e})),i.preventDefault())}}),document.addEventListener("click",function(i){if(t.active){i=i||window.event;for(var e=i.target,o=null;e&&e!==document;){if(-1!==l["default"].roles.indexOf(e.getAttribute("fe-role")))return o=t.getWidgetById(e.id),o&&o.isLeafWidget()?(o&&o.fire(new n["default"]("click",o)),i.preventDefault(),void(o.disabled||o.focus())):void 0;e=e.parentNode}}})},t.prototype.getFocusedLeaf=function(){return this.isLeafWidget()?this:this.getFocusedChildWidget()?this.getFocusedChildWidget().getFocusedLeaf():null},t.prototype.addClass=function(t){this.con.classList.add(t)},t.prototype.removeClass=function(t){this.con.classList.remove(t)},t.prototype.hasClass=function(t){return this.con.classList.contains(t)},t.prototype.show=function(){this.con.style.display="block"},t.prototype.hide=function(){this.con.style.display="none"},t.prototype.focus=function(t,i){if(t||!this.focused){for(var e=this;!e.isLeafWidget();){var o=e.getCachedChildWidget();if(o&&"yes"!==e.options.cfg.disable_child_cache)e=o;else{var s=e.getDefaultFocusedChildWidget();if(s)e=s;else{var r=e.getFirstFocusableChildWidget();if(!r)break;e=r}}}var h=new n["default"]("focus",e,{force:t});i&&h.preventListener(),e.fire(h)}},t.prototype.focusDefault=function(t){if(!this.focused||t.force){var i=this.getParentWidget();if(i){var e=i.getFocusedChildWidget();e&&e!==this&&e.blur(),i.setFocusedChildWidget(this)}this.addClass("fe-focus"),this.focused=!0,this.cache()}},t.prototype.blur=function(){var t=this.getParentWidget();t&&t.setFocusedChildWidget(null),this.removeClass("fe-focus"),this.focused=!1;var i=this.getFocusedChildWidget();i&&i.blur(),this.fire(new n["default"]("blur",this))},t.prototype.cache=function(){if(!this.cached){var t=this.getParentWidget();if(t){var i=t.getCachedChildWidget();i&&(i.removeClass("fe-cache"),i.cached=!1),t.setCachedChildWidget(this)}this.addClass("fe-cache"),this.cached=!0}},t.prototype.isLeafWidget=function(){return!this.getFirstFocusableChildWidget()},t.prototype.getParentWidget=function(){return this.parentWidget},t.prototype.getFocusedChildWidget=function(){if(!this.focusedChildWidget)return null;if(-1===this.childWidgets.indexOf(this.focusedChildWidget)){var t=this.getWidgetById(this.focusedChildWidget.id);return-1!==this.childWidgets.indexOf(t)?t:null}return this.focusedChildWidget},t.prototype.setFocusedChildWidget=function(t){t&&-1===this.childWidgets.indexOf(t)||(this.focusedChildWidget=t)},t.prototype.getCachedChildWidget=function(){return this.cachedChildWidget?-1===this.childWidgets.indexOf(this.cachedChildWidget)?null:this.cachedChildWidget.disabled?null:this.cachedChildWidget:null},t.prototype.setCachedChildWidget=function(t){t&&-1===this.childWidgets.indexOf(t)||(this.cachedChildWidget=t)},t.prototype.getDefaultFocusedChildWidget=function(){return this.defaultFocusedChildWidget?-1===this.childWidgets.indexOf(this.defaultFocusedChildWidget)?null:this.defaultFocusedChildWidget.disabled?null:this.defaultFocusedChildWidget:null},t.prototype.getFirstFocusableChildWidget=function(){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(!i.disabled)return i}return null},t.prototype.setDefaultFocusedChildWidget=function(t){t&&-1===this.childWidgets.indexOf(t)||(this.defaultFocusedChildWidget=t)},t.prototype.getWidgetById=function(t){if(this.id===t)return this;for(var i,e=0,o=this.childWidgets.length;o>e;e++){if(this.childWidgets[e].id===t)return this.childWidgets[e];if(i=this.childWidgets[e].getWidgetById(t))return i}return null},t.prototype.addChildWidget=function(t,i){i||0===i||(i=this.childWidgets.length),this.childWidgets.splice(i,0,t),t.parentWidget=this,"yes"===t.options.cfg.default_focus&&this.setDefaultFocusedChildWidget(t)},t.prototype.removeChildWidget=function(i){var e;if(i instanceof t)for(var o=0,s=this.childWidgets.length;s>o;o++)this.childWidgets[o]===i&&(e=this.childWidgets.splice(o,1));else e=this.childWidgets.splice(i,1);var r=e.length?e[0]:null;if(r&&r===this.getFocusedChildWidget()){var n=this.getDefaultFocusedChildWidget()===r?this.childWidgets[0]:this.getDefaultFocusedChildWidget();n.focus()}},t.prototype.getDOMNode=function(){return this.con},t.prototype.getWidgetRect=function(t){if(t&&this.rect)return this.rect;var i=this.getDOMNode(),e=i.getBoundingClientRect();return this.rect={top:e.top,bottom:e.bottom,right:e.right,left:e.left,width:e.width,height:e.height,centerX:e.width/2+e.left,centerY:e.height/2+e.top},this.rect},t.prototype.getWidgetRectAsync=function(t){var i=this;window.requestAnimationFrame(function(){var e=i.getDOMNode(),o=e.getBoundingClientRect(),s={top:o.top,bottom:o.bottom,right:o.right,left:o.left,width:o.width,height:o.height,centerX:o.width/2+o.left,centerY:o.height/2+o.top};i.rect||(i.rect=s),t&&t(s)})},t.prototype.on=function(t,i,e){var t=t.toLowerCase(),o=this.eventListeners[t];o||(o=this.eventListeners[t]={}),o[i]||(o[i]={cb:i,ctx:e})},t.prototype.detach=function(t,i){var t=t.toLowerCase(),e=this.eventListeners[t];e&&e[i]&&delete e[i]},t.prototype.fire=function(t){this.exeEventListeners(t),this.exeEventDefault(t);for(var i=this;i.parentWidget&&!t.isPropagationStopped();)i=i.parentWidget,i.exeEventListeners(t),i.exeEventDefault(t)},t.prototype.exeEventListeners=function(t){if(!t.isListenerPrevented()){var i=this.eventListeners[t.type];if(i){t.currentTarget=this;for(var e in i)i[e].cb.call(i[e].ctx,t)}}},t.prototype.exeEventDefault=function(t){var i=t.type+"Default";this[i]&&this[i](t)},t.prototype.destroy=function(t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].destroy(t);this.getParentWidget()&&this.getParentWidget().removeChildWidget(this),delete this.eventListeners,t&&this.con.parentNode.removeChild(this.con)},t.prototype._filterArray=function(t,i){return t.filter(function(t,e,o){return-1===i.indexOf(t)})},t.prototype._removeSpaces=function(t){return t?t.replace(/\s+/g,""):""},t.prototype.getEvents=function(){return["keydown","keyup","ok","okdown","click","focus","blur"]},t}();i["default"]=d,t.exports=i["default"]},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(i,"__esModule",{value:!0});var n=e(3),h=o(n),l=e(2),d=o(l),a=function(t){function i(e){s(this,i),t.call(this,e),this.minInterval=this.options.cfg.switch_interval>0?1e3*this.options.cfg.switch_interval:0,this.disableArea="yes"===this.options.cfg.switch_disable_area,this.disableShadow="yes"===this.options.cfg.switch_disable_shadow,this.useLeafRect="yes"===this.options.cfg.switch_use_leaf_rect,this.cacheRect=!0}return r(i,t),i.prototype.keydownDefault=function(t){this.isLeafWidget()||!t.isDefaultPrevented()&&t.target&&-1!==[d["default"].VK_LEFT,d["default"].VK_RIGHT,d["default"].VK_UP,d["default"].VK_DOWN].indexOf(t.keyCode)&&this.doSwitch(t)},i.prototype.doSwitch=function(t){var i=(new Date).getTime();if(i-this.lastKeydownTime<this.minInterval)return void t.preventDefault();this.lastKeydownTime=i;var e=this.getFocusedChildWidget(),o=e.options.dir,s=null,r=void 0,n=void 0;return t.keyCode===d["default"].VK_LEFT?(r=d["default"].VK_RIGHT,n="left"):t.keyCode===d["default"].VK_UP?(r=d["default"].VK_DOWN,n="up"):t.keyCode===d["default"].VK_RIGHT?(r=d["default"].VK_LEFT,n="right"):t.keyCode===d["default"].VK_DOWN&&(r=d["default"].VK_UP,n="down"),"yes"!==this.options.cfg.disable_cache_pre&&this.lastKeyCode===r&&this.lastFocusedChildWidget&&!this.lastFocusedChildWidget.disabled&&(s=this.lastFocusedChildWidget),!s&&o&&o[n]&&(s=this._getSiblingWidgetByCfg(e,o[n])),s||this.disableShadow||(s=this._getSiblingWidgetByShadowAlgorithm(e,n,t)),s||this.disableArea||(s=this._getSiblingWidgetByAreaAlgorithm(e,n,t)),s?(s.focus(),"yes"!==this.options.cfg.disable_cache_pre&&(this.lastFocusedChildWidget=e,this.lastKeyCode=t.keyCode),void t.preventDefault()):void this.fire(new d["default"]("switchend",this,{keyCode:t.keyCode}))},i.prototype._getSiblingWidgetByCfg=function(t,i){if(-1==i)return t;for(var e=0,o=this.childWidgets.length;o>e;e++){var s=this.childWidgets[e];if(s!==t&&!s.disabled&&s.options.tab===i&&"none"!==s.getDOMNode().style.display)return this.childWidgets[e]}return null},i.prototype._getSiblingWidgetByShadowAlgorithm=function(t,i,e){for(var o=this.useLeafRect&&e?e.target.getWidgetRect(this.cacheRect):t.getWidgetRect(this.cacheRect),s=[],r=0;r<this.childWidgets.length;r++){var n=this.childWidgets[r];if(n!==t&&!n.disabled){var h=n.getWidgetRect(this.cacheRect),l=!1;"left"===i&&(l=h.left<o.left&&h.top<o.bottom&&h.bottom>o.top),"right"===i&&(l=h.right>o.right&&h.top<o.bottom&&h.bottom>o.top),"up"===i&&(l=h.top<o.top&&h.left<o.right&&h.right>o.left),"down"===i&&(l=h.bottom>o.bottom&&h.left<o.right&&h.right>o.left),l&&s.push(n)}}if(0===s.length)return null;for(var d=1/0,a=null,r=0;r<s.length;r++){var c=s[r],f=c.getWidgetRect(this.cacheRect),u=Math.sqrt(Math.pow(f.centerX-o.centerX,2)+Math.pow(f.centerY-o.centerY,2));d>u&&(d=u,a=c)}return a},i.prototype._getSiblingWidgetByAreaAlgorithm=function(t,i,e){for(var o=this,s=this.useLeafRect&&e?e.target.getWidgetRect(this.cacheRect):t.getWidgetRect(this.cacheRect),r=s.centerX,n=s.centerY,h=[],l=0,d=this.childWidgets.length;d>l;l++){var a=this.childWidgets[l];if(a!==t&&!a.disabled){var c=a.getWidgetRect(this.cacheRect),f=c.centerX-r,u=-1*(c.centerY-n);if(0!==f||0!==u){var g=!1;"left"==i&&(g=0>u+f&&u-f>0),"up"==i&&(g=u+f>=0&&u-f>=0),"right"==i&&(g=u+f>0&&0>u-f),"down"==i&&(g=0>=u+f&&0>=u-f),g&&h.push(a)}}}if(0===h.length)return null;var p=1/0,y=void 0,v=null;return h.forEach(function(t){var i=t.getWidgetRect(o.cacheRect);y=Math.sqrt(Math.pow(i.centerX-r,2)+Math.pow(i.centerY-n,2)),p>y&&(p=y,v=t)}),v},i.prototype.getEvents=function(){return t.prototype.getEvents.call(this).concat(["switchend"])},i}(h["default"]);i["default"]=a,t.exports=i["default"]},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(i,"__esModule",{value:!0});var n=e(4),h=o(n),l=e(2),d=o(l),a=e(6),c=o(a),f=function(t){function i(e){var o=this;if(s(this,i),t.call(this,e),this.cacheRect=!1,this.dir="h"===this.options.cfg.scroll_dir?this.options.cfg.scroll_dir:"v",this.centerDOM="document"===this.options.cfg.scroll_center?this.options.cfg.scroll_center:"con",this.duration=this.options.cfg.scroll_duration?parseFloat(this.options.cfg.scroll_duration):.3,this.speedupDuration=this.options.cfg.scroll_speedup_duration?parseFloat(this.options.cfg.scroll_speedup_duration):.6*this.duration,this.easing=this.options.cfg.scroll_easing?this.options.cfg.scroll_easing:"ease",this.speedupEasing=this.options.cfg.scroll_speedup_easing?this.options.cfg.scroll_speedup_easing:"linear",this.useRAF="yes"===this.options.cfg.scroll_use_ram||"yes"===this.options.cfg.scroll_use_raf,this.lazyload="yes"!==this.options.cfg.disable_lazyload,this.lazyloadDelay=void 0!==this.options.cfg.lazyload_delay?parseFloat(this.options.cfg.lazyload_delay):.1,this.autoListWidth="yes"===this.options.cfg.auto_list_width,this.conList=this.con.querySelector(".scroll-list"),this.offset=0,this.desArr=[],!this.conList)throw new Error("[Focus Engine Scroll Error] Scroll\u7ec4\u4ef6\u5fc5\u987b\u542b\u6709\u4e00\u4e2a\u7c7b\u540d\u4e3ascroll-list\u7684\u5b50\u5143\u7d20\u3002");var r=getComputedStyle(this.conList);if("auto"!==r.left&&0!==parseInt(r.left)&&"h"===this.dir)throw new Error("[Focus Engine Scroll Error] \u6a2a\u5411Scroll\u5bb9\u5668\u7684.scroll-list\u5b50\u5143\u7d20\u4e0d\u53ef\u8bbe\u7f6eleft\u503c");if("auto"!==r.top&&0!==parseInt(r.top)&&"v"===this.dir)throw new Error("[Focus Engine Scroll Error] \u7eb5\u5411Scroll\u5bb9\u5668\u7684.scroll-list\u5b50\u5143\u7d20\u4e0d\u53ef\u8bbe\u7f6etop\u503c");"static"===r.position&&(this.conList.style.position="relative"),this._render(),this.autoListWidth&&this._setAutoListWidth();var n=this.getDefaultFocusedChildWidget();n&&this.scrollToWidget(n,0),this.lazyload&&setTimeout(function(){o.loadVisibleImage()},10)}return r(i,t),i.prototype._computeScrollRect=function(){if(this.conRect=this.getWidgetRect(),this.conWidth=this.conRect.width,this.conHeight=this.conRect.height,this.listRect=this.conList.getBoundingClientRect(),this.listWidth=this.listRect.width,this.listHeight=this.listRect.height,"document"===this.centerDOM){var t=document.documentElement.getBoundingClientRect();"v"===this.dir?this.center=t.height/2:this.center=t.width/2}else"v"===this.dir?this.center=this.conRect.height/2:this.center=this.conRect.width/2},i.prototype._setAutoListWidth=function(){this.rightPaddingWithUnit=this.options.cfg.scroll_right_padding,this.rightPadding=0,this.rightPaddingWithUnit&&(-1!==this.rightPaddingWithUnit.indexOf("rem")?this.rightPadding=parseFloat(this.rightPaddingWithUnit)*parseFloat(document.querySelector("html").style.fontSize):this.rightPadding=parseFloat(this.rightPaddingWithUnit)),this.conList.style.width="99999px";for(var t=0,i=this.childWidgets.length;i>t;t++){var e=this.childWidgets[t].getWidgetRect().right,o=e-this.listRect.left+this.rightPadding;o>this.listWidth&&(this.listWidth=o)}this.conList.style.width=this.listWidth+"px"},i.prototype.reRender=function(){var t=this;if(document.querySelector("#"+this.id)){if(this.con=document.querySelector("#"+this.id),this.conList=this.con.querySelector(".scroll-list"),!this.conList)throw new Error("[Focus Engine Scroll Error] Scroll\u7ec4\u4ef6\u5fc5\u987b\u542b\u6709\u4e00\u4e2a\u7c7b\u540d\u4e3ascroll-list\u7684\u5b50\u5143\u7d20\u3002");var i=getComputedStyle(this.conList);"static"===i.position&&(this.conList.style.position="relative"),this.options=this._getOptions(this.con),this.dir="h"===this.options.cfg.scroll_dir?this.options.cfg.scroll_dir:"v",this.centerDOM="ducoment"===this.options.cfg.scroll_center?this.options.cfg.scroll_center:"con",this.duration=this.options.cfg.scroll_duration?parseFloat(this.options.cfg.scroll_duration):.3,this.easing=this.options.cfg.scroll_easing?this.options.cfg.scroll_easing:"linear",this.useRAF="yes"===this.options.cfg.scroll_use_ram||"yes"===this.options.cfg.scroll_use_raf,this._render(!0),this._reRenderChildWidget(),this.autoListWidth&&this._setAutoListWidth(),this.lazyload&&setTimeout(function(){t.loadVisibleImage()},10)}},i.prototype._render=function(t){var i=this;this._computeScrollRect(),t||("v"===this.dir?this.conList.style.top="0px":this.conList.style.left="0px"),this.useRAF||("v"===this.dir?(this.conList.style.transition="top "+this.duration+"s "+this.easing,this.conList.style.webkitTransition="top "+this.duration+"s "+this.easing):(this.conList.style.transition="left "+this.duration+"s "+this.easing,this.conList.style.webkitTransition="left "+this.duration+"s "+this.easing),t||(this.rendered=!1,this.conList.addEventListener("webkitTransitionEnd",function(t){t.target===i.conList&&(i.rendered&&i.fire(new d["default"]("scrollend",i)),i.rendered=!0)}),this.conList.addEventListener("transitionend",function(t){t.target===i.conList&&(i.rendered&&i.fire(new d["default"]("scrollend",i)),i.rendered=!0)})))},i.prototype.focusDefault=function(i){if(t.prototype.focusDefault.call(this,i),this.getFirstFocusableChildWidget()&&!i.isDefaultPrevented()){if(!(this.conWidth||this.conHeight||this.listWidth||this.listHeight||this.center)){this._computeScrollRect(),this.autoListWidth&&this._setAutoListWidth();var e=this.getDefaultFocusedChildWidget();if(e)return void this.scrollToWidget(e,0)}this.doScroll(i)}},i.prototype.scrollstartDefault=function(t){this.loadImageTimeout&&clearTimeout(this.loadImageTimeout)},i.prototype.scrollendDefault=function(t){var i=this;this.lazyload&&t.target===this&&(this.loadImageTimeout=setTimeout(function(){i.loadVisibleImage()},1e3*this.lazyloadDelay))},i.prototype.doSwitch=function(i){t.prototype.doSwitch.call(this,i)},i.prototype.doScroll=function(t){var i=this.getFocusedChildWidget();this.scrollToWidget(i,this.duration,t)},i.prototype.scrollToWidget=function(t,i,e){var o=this.computeOffsetByWidget(t);void 0===i&&(i=this.duration),this.scrollListTo(o,i,e)},i.prototype.computeOffsetByWidget=function(t){if("yes"===t.options.cfg.scroll_to_start)return 0;if("yes"===t.options.cfg.scroll_to_end)return"v"===this.dir?this.conHeight-this.listHeight:this.conWidth-this.listWidth;this._computeScrollRect();var i=this.center-this._getExpectCenter(t);if("v"===this.dir){if(0>i){if(this.offset+i<this.conHeight-this.listHeight&&(i=this.conHeight-this.listHeight-this.offset,i>0))return this.offset}else{if(!(i>0))return this.offset;if(-1*this.offset<i&&(i=-1*this.offset,0>i))return this.offset}return this.offset+i}if(0>i){if(this.offset+i<this.conWidth-this.listWidth&&(i=this.conWidth-this.listWidth-this.offset,i>0))return this.offset}else{if(!(i>0))return this.offset;if(-1*this.offset<i&&(i=-1*this.offset,0>i))return this.offset}return this.offset+i},i.prototype.scrollListTo=function(t,i,e){var o=this;void 0===i&&(i=this.duration),this.fire(new d["default"]("scrollstart",this)),this.useRAF?(e&&"focus"===e.type&&(this.futureOffset=t),this.desArr.push(t),1===this.desArr.length&&this.doAnimate(i,this.easing)):(this.offset=t,"v"===this.dir?(this.conList.style.transition="top "+i+"s "+this.easing,this.conList.style.webkitTransition="top "+i+"s "+this.easing):(this.conList.style.transition="left "+i+"s "+this.easing,this.conList.style.webkitTransition="left "+i+"s "+this.easing),setTimeout(function(){"v"===o.dir?(o.conList.style.transition="top "+o.duration+"s "+o.easing,o.conList.style.webkitTransition="top "+o.duration+"s "+o.easing):(o.conList.style.transition="left "+o.duration+"s "+o.easing,o.conList.style.webkitTransition="left "+o.duration+"s "+o.easing)},1),"v"===this.dir?this.conList.style.top=this.offset+"px":this.conList.style.left=this.offset+"px",e&&"focus"===e.type&&(this.futureOffset=this.offset))},i.prototype.doAnimate=function(t,i){var e=this;if(this.desArr[0]===this.offset)return void this.desArr.shift();var o=function(){e.scrollEndTimeout&&clearTimeout(e.scrollEndTimeout),e.offset=e.desArr.shift(),e.desArr.length>0?e.doAnimate(e.speedupDuration,e.speedupEasing):e.scrollEndTimeout=setTimeout(function(){e.fire(new d["default"]("scrollend",e))},50)};(0,c["default"])({dom:this.conList,style:"v"===this.dir?"top":"left",start:this.offset,end:this.desArr[0],duration:t,easing:i,cb:o})},i.prototype._getExpectCenter=function(t){var i=t.getWidgetRect();return"v"===this.dir?this.offset+i.centerY-this.listRect.top:this.offset+i.centerX-this.listRect.left},i.prototype.getListNode=function(){return this.conList},i.prototype.loadVisibleImage=function(){for(var t=this.getWidgetRect(),i=t.left,e=t.top,o=t.right,s=t.bottom,r=this.con.querySelectorAll(".fe-lazyload"),n=function(t){var n=r[t],h=n.getAttribute("fe-src"),l=n.getBoundingClientRect();if(n.src!==h&&!(l.left<=i&&l.right<=i||l.left>=o&&l.right>=o||l.top>=s&&l.bottom>=s||l.top<=e&&l.bottom<=e)){var d=new Image;d.src=h,d.onload=function(){n.src=h}}},h=0;h<r.length;h++)n(h)},i.prototype.getEvents=function(){return t.prototype.getEvents.call(this).concat(["scrollstart","scrollend"])},i}(h["default"]);i["default"]=f,t.exports=i["default"]},function(t,i){"use strict";function e(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function o(t){if(!(t&&t.dom&&t.style&&void 0!==t.start&&void 0!==t.end))throw new Error("animate\u65b9\u6cd5\u7684cfg\u53c2\u6570\uff1adom\u3001style\u3001start\u3001end\u5fc5\u9700\uff01");var i=t.dom,e=t.style,o=t.start,s=t.end,l=void 0!==t.duration?1e3*t.duration:1e3,d=t.delay?1e3*t.delay:0,a=t.easing||"ease",c=t.unit||"px",f=t.cb||null,u=s-o,g=Date.now()+d,p=g+l;if(0===u&&(l=0),n.push({dom:i,style:e,start:o,change:u,end:s,duration:l,easing:a,unit:c,cb:f,change:u,startTime:g,endTime:p}),!h){window.yunos?0:10;h=setInterval(function(){for(var t=Date.now(),i=n.length,e=0,o=function(){var o=n[e];if(t<o.startTime)return e++,"continue";if(t<o.endTime){var s=r[o.easing]((t-o.startTime)/o.duration);return o.dom.style[o.style]=o.start+s*o.change+o.unit,e++,"continue"}o.dom.style[o.style]=o.end+o.unit,setTimeout(function(){o.cb&&o.cb()},0),n.splice(e,1),i--,0===i&&(clearInterval(h),h=null)};i>e;){o()}},0)}}Object.defineProperty(i,"__esModule",{value:!0});var s,r=(s={linear:function(t){return t}},e(s,"ease-in",function(t){return t*t}),e(s,"ease-out",function(t){return t*(2-t)}),e(s,"ease-in-out",function(t){return.5>t?2*t*t:-1+(4-2*t)*t}),e(s,"ease",function(t){return.5>t?2*t*t:-1+(4-2*t)*t}),e(s,"easeInQuad",function(t){return t*t}),e(s,"easeOutQuad",function(t){return t*(2-t)}),e(s,"easeInOutQuad",function(t){return.5>t?2*t*t:-1+(4-2*t)*t}),e(s,"easeInCubic",function(t){return t*t*t}),e(s,"easeOutCubic",function(t){return--t*t*t+1}),e(s,"easeInOutCubic",function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1}),e(s,"easeInQuart",function(t){return t*t*t*t}),e(s,"easeOutQuart",function(t){return 1- --t*t*t*t}),e(s,"easeInOutQuart",function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t}),e(s,"easeInQuint",function(t){return t*t*t*t*t}),e(s,"easeOutQuint",function(t){return 1+--t*t*t*t*t}),e(s,"easeInOutQuint",function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t}),s),n=[],h=null;i["default"]=o,t.exports=i["default"]},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(i,"__esModule",{value:!0});var n=e(3),h=o(n),l=e(2),d=o(l),a=e(6),c=o(a),f=function(t){function i(e){s(this,i),t.call(this,e),this._init(),this._writeGridInnerHTML(),t.prototype._initChildWidgets.call(this),this._checkWidgets()}return r(i,t),i.prototype._initChildWidgets=function(){},
i.prototype.reRender=function(){if(document.querySelector("#"+this.id)){this.con=document.querySelector("#"+this.id);var i=this.childWidgets[0],e=this.getDOMNode().children[0],o=!1;e!==i.getDOMNode()&&(this.templateHTML=e.outerHTML,o=!0);var s=this._getOptions(this.con);(this.options.cfg.grid_dir!==s.cfg.grid_dir||this.options.cfg.grid_row!==s.cfg.grid_row||this.options.cfg.grid_col!==s.cfg.grid_col)&&(this.options=s,o=!0),o&&(this.setCachedChildWidget(null),this.setFocusedChildWidget(null),this._init(),this._writeGridInnerHTML(),t.prototype._initChildWidgets.call(this),this._checkWidgets(),this.focused&&this.focus(!0))}},i.prototype._init=function(){if(this.horizontal="h"===this.options.cfg.grid_dir,isNaN(this.options.cfg.grid_row)||isNaN(this.options.cfg.grid_col))throw new Error("[Focus Engine Grid Error] Grid\u7ec4\u4ef6\u5fc5\u987b\u8bbe\u7f6e\u884c\u548c\u5217\uff01\u884c\u5217\u6570\u4e3a\u89c6\u53e3\u5185\u53ef\u89c1\u7684\u6700\u591a\u884c\u5217\u6570\u3002");this.duration=void 0!==this.options.cfg.grid_duration?parseFloat(this.options.cfg.grid_duration):.3,this.speedupDuration=void 0!==this.options.cfg.grid_speedup_duration?parseFloat(this.options.cfg.grid_speedup_duration):.6*this.duration,this.easing=this.options.cfg.grid_easing?this.options.cfg.grid_easing:"ease",this.speedupEasing=this.options.cfg.grid_speedup_easing?this.options.cfg.grid_speedup_easing:"linear",this.delay=void 0!==this.options.cfg.grid_delay?parseFloat(this.options.cfg.grid_delay):this.duration/this.col/1.5,this.row=parseInt(this.options.cfg.grid_row)+2,this.col=parseInt(this.options.cfg.grid_col),this.horizontal&&(this.row=parseInt(this.options.cfg.grid_row),this.col=parseInt(this.options.cfg.grid_col)+2),this.originSize=this.options.cfg.grid_origin_size?parseInt(this.options.cfg.grid_origin_size):1,1!==this.originSize&&(this.horizontal?this.col=this.originSize+2:this.row=this.originSize+2),this.data=this.data||[],this.itemRender=this.itemRender||null,this.scrolling=!1,this.upRow=0,this.downRow=this.row-1,this.lefCol=0,this.rightCol=this.col-1,this.origin=0,this.dataIndex=0},i.prototype._writeGridInnerHTML=function(){if(!this.templateHTML){var t=this.getDOMNode().children[0];t.id="",t.setAttribute("fe-role","Widget"),this.templateHTML=t.outerHTML,this.templateDOM=t}var i="";if(this.horizontal){var e=getComputedStyle(this.templateDOM);i="left"===e["float"]||"right"===e["float"]?'<i style="width:0;height:0;clear:both;float:'+e["float"]+';"></i>':'<br style="font-size:0px;"/>'}for(var o="",s=0;s<this.col;s++)o+=this.templateHTML;o+=i;for(var r="",s=0;s<this.row;s++)r+=o;this.horizontal&&(r='<div style="width:99999px;height:100%;">'+r+"</div>"),this.getDOMNode().innerHTML=r},i.prototype._checkWidgets=function(){var t=this.getWidgetRect();if(this.conHeight=t.height,this.conWidth=t.width,this.row>1&&(this.rowHeight=this.childWidgets[this.col].getWidgetRect().centerY-this.childWidgets[0].getWidgetRect().centerY),this.colWidth=this.childWidgets[1].getWidgetRect().centerX-this.childWidgets[0].getWidgetRect().centerX,this.originArr=[],1===this.originSize)this.horizontal?this.originArr.push(this.conWidth/2):this.originArr.push(this.conHeight/2);else if(this.horizontal)for(var i=0,e=this.colWidth/2;i<this.originSize;i++)this.originArr.push(e+i*this.colWidth);else for(var i=0,o=this.rowHeight/2;i<this.originSize;i++)this.originArr.push(o+i*this.rowHeight);this.curWid=this.childWidgets[0];for(var i=0;i<this.childWidgets.length;i++){var s=this.childWidgets[i];getComputedStyle(s.getDOMNode());s.oriOffsetCY=s.getWidgetRect().centerY-t.top,s.oriCenteY=s.oriOffsetCY,s.oriOffsetCX=s.getWidgetRect().centerX-t.left,s.oriCenteX=s.oriOffsetCX,s.row=Math.floor(i/this.col),s.col=i%this.col,s.offset=0,s.animationArr=[],s.isEmpty=!0,s.offsetRow=s.row,s.offsetCol=s.col,s.whichData=i}},i.prototype.keydownDefault=function(t){if(this.stopSwitch)return void t.preventDefault();if(!t.isDefaultPrevented()){var i=this._getNextDataIndex(t.keyCode);if(-1!==i){t.preventDefault();var e=null;e=this.horizontal?this.childWidgets[Math.floor(i/this.row)%this.col+i%this.row*this.col]:this.childWidgets[Math.floor(i/this.col)%this.row*this.col+i%this.col],e.focus()}}},i.prototype._getNextDataIndex=function(t){var i=this.dataIndex;return t===d["default"].VK_LEFT?this.horizontal||i%this.col===0?this.horizontal&&i>=this.row?i-=this.row:-1:--i:t===d["default"].VK_RIGHT?!this.horizontal&&i%this.col!==this.col-1&&i+1<this.data.length?++i:this.horizontal&&i+this.row<this.data.length?i+=this.row:this.horizontal&&i+this.row>=this.data.length&&Math.floor(i/this.row)<Math.floor((this.data.length-1)/this.row)?this.data.length-1:(this.horizontal&&this.fire(new d["default"]("reachend",this)),-1):t===d["default"].VK_UP?!this.horizontal&&i>=this.col?i-=this.col:this.horizontal&&i%this.row!==0?--i:-1:t===d["default"].VK_DOWN?!this.horizontal&&i+this.col<this.data.length?i+=this.col:!this.horizontal&&i+this.col>=this.data.length&&Math.floor(i/this.col)<Math.floor((this.data.length-1)/this.col)?this.data.length-1:this.horizontal&&i%this.row!==this.row-1&&i+1<this.data.length?++i:(this.horizontal||this.fire(new d["default"]("reachend",this)),-1):-1},i.prototype.focusDefault=function(i){if(t.prototype.focusDefault.call(this,i),!this.isSetData){this.conHeight||this.conWidth||this._checkWidgets();var e=this.getFocusedChildWidget();this.dataIndex=e.whichData,this.curWid=e,this.horizontal&&0===e.offsetCol||(this.horizontal||0!==e.offsetRow)&&(this._computeGridStatus(e),this._computeAllWidgetStatus(e))}},i.prototype._computeGridStatus=function(t){this.horizontal?this._computeGridStatus_h(t):this._computeGridStatus_v(t)},i.prototype._computeGridStatus_v=function(t){if(this.isSetData||(this.isUp=t.offsetRow<0,this.isUp&&this.origin>0?this.origin--:!this.isUp&&this.origin<this.originArr.length-1&&this.origin++),this.focsedCY=this.originArr[this.origin],1===this.originSize){this.upRow=Math.floor(this.row/2),this.downRow=Math.floor(this.row/2);var i=Math.floor(this.dataIndex/this.col),e=Math.floor((this.data.length-1)/this.col),o=this.focsedCY,s=(e-i)*this.rowHeight+this.rowHeight/2;o>s&&(this.focsedCY=this.conHeight-s,this.downRow=e-i,this.upRow=this.row-1-this.downRow);var r=i*this.rowHeight+this.rowHeight/2,n=(e+1)*this.rowHeight;if(o>r||n<this.conHeight)return this.focsedCY=r,this.upRow=i,void(this.downRow=this.row-1-this.upRow)}else{if(this.upRow=this.origin+1,this.downRow=this.originSize-this.origin,0===Math.floor(this.dataIndex/this.col))return this.upRow=0,void(this.downRow=this.row-1);Math.floor(this.dataIndex/this.col)===Math.floor((this.data.length-1)/this.col)&&(this.upRow=this.row-1,this.downRow=0)}},i.prototype._computeGridStatus_h=function(t){if(this.isSetData||(this.isLeft=t.offsetCol<0,this.isLeft&&this.origin>0?this.origin--:!this.isLeft&&this.origin<this.originArr.length-1&&this.origin++),this.focsedCX=this.originArr[this.origin],1===this.originSize){this.leftCol=Math.floor(this.col/2),this.rightCol=Math.floor(this.col/2);var i=Math.floor(this.dataIndex/this.row),e=Math.floor((this.data.length-1)/this.row),o=this.focsedCX,s=(e-i)*this.colWidth+this.colWidth/2;o>s&&(this.focsedCX=this.conWidth-s,this.rightCol=e-i,this.leftCol=this.col-1-this.rightCol);var r=i*this.colWidth+this.colWidth/2,n=(e+1)*this.colWidth;if(o>r||n<this.conWidth)return this.focsedCX=r,this.leftCol=i,void(this.rightCol=this.col-1-this.leftCol)}else{if(this.leftCol=this.origin+1,this.rightCol=this.originSize-this.origin,this.dataIndex<this.row)return this.leftCol=0,void(this.rightCol=this.col-1);Math.floor(this.dataIndex/this.row)===Math.floor((this.data.length-1)/this.row)&&(this.leftCol=this.col-1,this.rightCol=0)}},i.prototype._computeAllWidgetStatus=function(t){this.horizontal?this._computeAllWidgetStatus_h(t):this._computeAllWidgetStatus_v(t)},i.prototype._computeAllWidgetStatus_v=function(t){var i=t.row,e=Math.floor(this.dataIndex/this.col);this._computeRowWidgetStatus(i,e,0);for(var o=-1;o>=-this.upRow;o--)this._computeRowWidgetStatus(i,e,o);for(var o=1;o<=this.downRow;o++)this._computeRowWidgetStatus(i,e,o)},i.prototype._computeAllWidgetStatus_h=function(t){var i=t.col,e=Math.floor(this.dataIndex/this.row);this._computeColWidgetStatus(i,e,0);for(var o=-1;o>=-this.leftCol;o--)this._computeColWidgetStatus(i,e,o);for(var o=1;o<=this.rightCol;o++)this._computeColWidgetStatus(i,e,o)},i.prototype._computeRowWidgetStatus=function(t,i,e){for(var o=(t+e+this.row)%this.row,s=i+e,r=0;r<this.col;r++){var n=this.childWidgets[this.col*o+r],h=this.col*s+r,l="visible";if((h>=this.data.length||0>h)&&(l="hidden"),n.whichData=h,n.whichDataRow=s,this.isSetData)n.offset=this.focsedCY+e*this.rowHeight-n.oriCenteY,n.getDOMNode().style.top=n.offset+"px",n.getDOMNode().style.visibility=l,n.offsetRow=e;else{var d=r;this.isUp&&(d=this.col-d-1);var a=this.focsedCY+e*this.rowHeight-n.oriCenteY;n.futureOffset=a,n.animationArr.push({offset:a,duration:this.duration,jump:n.offsetRow*e<0,visibility:l}),this.triggerWidgetAnimation(n,d*this.delay),n.offsetRow=e}}},i.prototype._computeColWidgetStatus=function(t,i,e){for(var o=(t+e+this.col)%this.col,s=i+e,r=0;r<this.row;r++){var n=this.childWidgets[o+r*this.col],h=s*this.row+r,l="visible";if((h>=this.data.length||0>h)&&(l="hidden"),n.whichData=h,n.whichDataCol=s,this.isSetData)n.offset=this.focsedCX+e*this.colWidth-n.oriCenteX,n.getDOMNode().style.left=n.offset+"px",n.getDOMNode().style.visibility=l,n.offsetCol=e;else{var d=r;this.isLeft&&(d=this.row-d-1);var a=this.focsedCX+e*this.colWidth-n.oriCenteX;n.futureOffset=a,n.animationArr.push({offset:a,duration:this.duration,jump:n.offsetCol*e<0,visibility:l}),this.triggerWidgetAnimation(n,d*this.delay),n.offsetCol=e}}},i.prototype.triggerWidgetAnimation=function(t,i){this.scrolling||(this.scrolling=!0,this.fire(new d["default"]("scrollstart",this))),1===t.animationArr.length&&this.startScroll(t,i)},i.prototype.startScroll=function(t,i,e){var o=this,s=function(){o.scrollEndTimeout&&clearTimeout(o.scrollEndTimeout);var i=t.animationArr.shift();t.offset=i.offset,t.getDOMNode().style.visibility=i.visibility,t.animationArr.length>0?o.startScroll(t,0,!0):o.scrollEndTimeout=setTimeout(function(){o.scrolling&&(o.scrolling=!1,o.fire(new d["default"]("scrollend",o)))},100)};this.stopSwitch=t.animationArr.length>=parseInt((this.horizontal?this.col:this.row)/2);var r=t.animationArr[0];r.jump&&(t.isEmpty||(this.itemRender(t.getDOMNode()),t.isEmpty=!0));var n=r.duration,h=this.easing;e&&(h=this.speedupEasing,0!==n&&(n=this.speedupDuration)),(0,c["default"])({dom:t.getDOMNode(),style:this.horizontal?"left":"top",start:r.jump?r.offset:t.offset,end:r.offset,duration:n,delay:i,easing:h,cb:s})},i.prototype.scrollendDefault=function(t){var i=this;t.isDefaultPrevented()||this.scrolling||(this.loadContentTimeout&&clearTimeout(this.loadContentTimeout),this.loadContentTimeout=setTimeout(function(){i.loadContent()},100))},i.prototype.scrollstartDefault=function(t){t.isDefaultPrevented()||(this.loadContentTimeout&&clearTimeout(this.loadContentTimeout),window.stopImgLoading&&window.stopImgLoading())},i.prototype.setItemRender=function(t){this.itemRender=t},i.prototype.addData=function(t){if(Array.isArray(t)){var i=this.data.concat(t),e=this.focused?this.getFocusedChildWidget().whichData:this.dataIndex;this.setData(i,e,this.origin)}},i.prototype.setData=function(t,i,e){Array.isArray(t)&&(this.data=t.concat([])),this.horizontal?this.allDataCol=Math.floor(this.data.length/this.row):this.allDataRow=Math.floor(this.data.length/this.col),void 0!==i&&i<this.data.length?this.dataIndex=i:this.dataIndex=0,void 0!==e&&e<this.originSize?this.origin=e:(this.origin=Math.floor(this.dataIndex/this.col),this.origin>=this.originSize&&(this.origin=this.originSize-1));var o=this.childWidgets[Math.floor(this.dataIndex/this.col)%this.row*this.col+this.dataIndex%this.col];this.isSetData=!0,this._computeGridStatus(o),this._computeAllWidgetStatus(o),o.dataIndex=this.dataIndex,this.focused?o.focus(!0,!0):o.cache(),this.curWid=o,this.loadContent(),this.isSetData=!1},i.prototype.loadContent=function(){for(var t=0,i=this.childWidgets.length;i>t;t++){var e=this.childWidgets[t];if(e.isEmpty||this.isSetData){var o=this.data[e.whichData];this.itemRender&&this.itemRender(e.getDOMNode(),o),e.isEmpty=!1}}window.resumeImgLoading&&window.resumeImgLoading(),this.fire(new d["default"]("contentloaded",this))},i.prototype.getEvents=function(){return t.prototype.getEvents.call(this).concat(["reachend","contentloaded"])},i}(h["default"]);i["default"]=f,t.exports=i["default"]},function(t,i,e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(i,"__esModule",{value:!0});var n=e(1),h=o(n),l=e(3),d=o(l),a=e(2),c=o(a),f=e(6),u=(o(f),function(t){function i(e){s(this,i),t.call(this,e),this._init()}return r(i,t),i.prototype._init=function(){var t=this;this.listDom=document.createElement("div"),this.listDom.style.position="relative",this.listDom.style.width="100%",this.con.innerHTML="",this.con.appendChild(this.listDom),this.duration=void 0!==this.options.cfg.duration?parseFloat(this.options.cfg.duration):.3,this.delay=void 0!==this.options.cfg.delay?parseFloat(this.options.cfg.delay):.1,this.easing=this.options.cfg.easing?this.options.cfg.easing:"ease-out",this.bottomPadding=void 0!==this.options.cfg.bottom_padding?parseFloat(this.options.cfg.bottom_padding):0,this.visibleRow=void 0!==this.options.cfg.visible_row?parseInt(this.options.cfg.visible_row):5,this.listDom.style.transition="transform "+this.duration+"s "+this.easing,this.listDom.addEventListener("transitionend",function(i){i.target===t.listDom&&t.fire(new c["default"]("scrollend",t))}),this.getWidgetRect(),this.align=this.rect.height/2,this.offset=0,this._reset()},i.prototype._reset=function(){this.lastWidgetRow=0,this.lastWidgetCol=0,this.lastWidgetCenter=0,this.listHeight=0,this.childrenArr=[],this.childWidgets=[],this.childItems=[],this.focusPos={row:0,col:0}},i.prototype.setData=function(t,i){var e=this;if(this.isSetData=!0,0==this.childItems.length)return this.listDom.innerHTML="",this._reset(),this.dataIndex=void 0!==i?i:0,this.data=[].concat(t),void this._renderChildren();for(var o=!1,s=0;s<this.childItems.length;s++){var r=this.childItems[s];r.con&&r.visible&&(r.con.style.transform="scale3d(0.3,0.3,0.3)",o||(o=!0,r.con.addEventListener("transitionend",function(o){e.listDom.innerHTML="",e._reset(),e.dataIndex=void 0!==i?i:0,e.data=[].concat(t),e._renderChildren()})))}},i.prototype.addData=function(t){this.data=this.data.concat(t),this._renderChildren()},i.prototype.setItemRender=function(t){this.itemRender=t},i.prototype._renderChildren=function(){var t=this;if(this.data&&this.itemRender){this.isSetData&&(this.listDom.style.visibility="hidden");for(var i=function(i){var e=t.data[i],o=t.itemRender(e);if("string"==typeof o){var s=document.createElement("div");if(s.innerHTML=o,s.children.length>1)throw new Error("[Focus Engine Grille Error] Grille\u7ec4\u4ef6\u7684itemRender\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u5fc5\u987b\u662f\u53ef\u89e3\u6790\u6210\u4e00\u4e2adom\u5bf9\u8c61\u3002");o=s.children[0]}var r=o.querySelector(".grille-lazyload");if(r&&o.removeChild(r),t.listDom.appendChild(o),!o.getAttribute("fe-role"))return t.childItems.push(o),"continue";var n=h["default"].createWidget(o);t.addChildWidget(n),t.childItems.push(n),n.data=e,n.index=i,n.lazyDom=r,n.getWidgetRectAsync(function(e){n.oriOffset=e.centerY-t.rect.top-t.offset,t.listHeight<e.bottom-t.rect.top-t.offset+t.bottomPadding&&(t.listHeight=e.bottom-t.rect.top-t.offset+t.bottomPadding),t.lastWidgetCenter?e.centerY-t.offset===t.lastWidgetCenter?(n.row=t.lastWidgetRow,t.lastWidgetCol++,n.col=t.lastWidgetCol,t.childrenArr[t.lastWidgetRow].push(n)):e.centerY-t.offset>t.lastWidgetCenter&&(t.lastWidgetRow++,n.row=t.lastWidgetRow,t.lastWidgetCol=0,n.col=t.lastWidgetCol,t.lastWidgetCenter=e.centerY-t.offset,t.childrenArr[t.lastWidgetRow]=[n]):(n.row=t.lastWidgetRow,n.col=t.lastWidgetCol,t.lastWidgetCenter=e.centerY,t.childrenArr[t.lastWidgetRow]=[n]),n.row<=t.visibleRow&&(n.visible=!0,n.con.style.transition="transform "+.8*t.duration+"s "+t.easing),i===t.data.length-1&&(t.focused&&t.childItems[t.dataIndex].focus(),t.isSetData&&setTimeout(function(){t.listDom.style.visibility="visible";var i=t.childItems[t.dataIndex];t.loadContent(),t._doScroll(i),t.setCachedChildWidget(i)},100))})},e=this.childItems.length;e<this.data.length;e++){i(e)}}},i.prototype.focusDefault=function(i){t.prototype.focusDefault.call(this,i),i.target!==this&&(this.isSetData||(this.dataIndex=i.target.index,this._doScroll(i.target)))},i.prototype._doScroll=function(t){var i=this;if(this.focusPos.row=t.row,this.focusPos.col=t.col,!(this.listHeight<this.rect.height)){var e=this.align-t.oriOffset;if(e>0&&(e=0),this.listHeight-t.oriOffset<this.rect.height-this.align&&(e=this.rect.height-this.listHeight),void 0!==t.data.align&&(e=this.align-t.oriOffset),this.offset!==e||this.isSetData)if(this.isSetData)this.listDom.style.transition="",this.listDom.style.transform="translateY("+(e+this.rect.height)+"px)",this.offset=e+this.rect.height,setTimeout(function(){i.listDom.style.transition="transform "+i.duration+"s "+i.easing,i.listDom.style.transform="translateY("+e+"px)";var t=-i.rect.height/3;i.offset=e,!i.isScrolling&&i.fire(new c["default"]("scrollstart",i,{des:t})),i.isSetData=!1},10);else{this.listDom.style.transition="transform "+this.duration+"s "+this.easing,this.listDom.style.transform="translateY("+e+"px)";var o=e-this.offset;this.offset=e,!this.isScrolling&&this.fire(new c["default"]("scrollstart",this,{des:o}))}}},i.prototype.keydownDefault=function(t){var i=this.focusPos.row,e=this.focusPos.col;if(t.keyCode===c["default"].VK_UP&&i>0&&(i--,e>=this.childrenArr[i].length&&(e=this.childrenArr[i].length-1),t.preventDefault()),t.keyCode===c["default"].VK_DOWN&&i<this.lastWidgetRow&&(i++,e>=this.childrenArr[i].length&&(e=this.childrenArr[i].length-1),t.preventDefault()),t.keyCode===c["default"].VK_LEFT&&e>0&&(e--,t.preventDefault()),t.keyCode===c["default"].VK_RIGHT&&e<this.childrenArr[i].length-1&&(e++,t.preventDefault()),i!==this.focusPos.row||e!==this.focusPos.col){this.focusPos.row=i,this.focusPos.col=e;var o=this.childrenArr[i][e];o.focus()}},i.prototype.scrollstartDefault=function(t){this.isScrolling=!0,clearTimeout(this.loadContentTimeout);for(var i=this.childItems[this.dataIndex],e=0;e<this.childWidgets.length;e++){var o=this.childWidgets[e],s=-Math.abs(o.col-i.col)*t.des*this.delay;o.con.style.transform="translateY("+s+"px)"}},i.prototype.scrollendDefault=function(t){var i=this;this.isScrolling=!1;for(var e=this.childItems[this.dataIndex],o=0;o<this.childWidgets.length;o++){var s=this.childWidgets[o],r=Math.floor(this.visibleRow/2);Math.abs(s.row-e.row)<=r?(s.con.style.transition="transform "+.8*this.duration+"s "+this.easing,s.visible=!0):s.visible&&(s.con.style.transition="",s.visible=!1),s.con.style.transform=""}this.loadContentTimeout=setTimeout(function(){i.loadContent()},500)},i.prototype.loadContent=function(){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.lazyDom&&i.visible&&!i.lazyLoaded?(i.con.appendChild(i.lazyDom),i.lazyLoaded=!0):i.lazyDom&&!i.visible&&i.lazyLoaded&&(i.con.removeChild(i.lazyDom),i.lazyLoaded=!1)}this.fire(new c["default"]("contentloaded",this))},i.prototype.getEvents=function(){return t.prototype.getEvents.call(this).concat(["scrollstart","scrollend","contentloaded"])},i}(d["default"]));i["default"]=u,t.exports=i["default"]}]);